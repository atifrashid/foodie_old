<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Fudi</title>

<!-- Sets initial viewport load and disables zooming  -->
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width" />

<!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="mobile-web-app-capable" content="yes">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/font-awesome.min.css" rel="stylesheet">
<link href="css/styles.css" rel="stylesheet">
</head>
<body id="wrapper">
<div id="sidebar-wrapper">
	<nav id="nav">
		<ul class="sidebar-nav nav" id="navRight">
			<li class="L0 menu-heading"><strong><a href="#"><i class="icon-user"></i> <span data-bind="text: lang.Foodie"></span></a></strong></li>
			<li class="L2"><a class="sub" href="map.html"><i class="icon-pointer-advice"></i> <span data-bind="text: lang.mnuChefs"></span></a></li>
			<li class="L2"><a class="sub" href="user-profile.html"><i class="icon-user"></i> <span data-bind="text: lang.MyProfile"></span></a></li>
			<li class="L2"><a class="sub" href="payment-options.html"><i class="icon-credit-cards"></i> <span data-bind="text: lang.PO"></span></a></li>
			<li class="L2"><a class="sub" href="reservations.html"><i class="icon-tray"></i> <span data-bind="text: lang.MyOrders"></span></a></li>
			<li class="L2"><a class="sub" href="notifications.html"><i class="icon-mail"></i> <span data-bind="text: lang.Notifications"></span></a></li>
			<!--<li class="L2"><a class="sub" href="events-list.html"><i class="fa fa-glass"></i> <span data-bind="text: lang.Events"></span></a></li>-->
			<li class="L0 menu-heading"><strong><a href="#"><i class="icon-chef"></i> <span data-bind="text: lang.CHEF"></span></a></strong></li>
			<li class="L2 noChef"><a class="sub" href="chef-profile-edit.html"><i class="icon-chef"></i> <span data-bind="text: lang.BecomeaChef"></span></a></li>
			<li class="L2 isChef pChef"><a class="sub" href="chef-profile-edit.html"><i class="icon-chef"></i> <span data-bind="text: lang.ChefProfile"></span></a></li>
			<li class="L2 isChef"><a class="sub" href="chef-dishes.html"><i class="icon-food"></i> <span data-bind="text: lang.ManageDishes"></span></a></li>
			<li class="L2 isChef"><a class="sub" href="chef-calendar-set.html"><i class="icon-clock"></i> <span data-bind="text: lang.Schedule"></span></a></li>
			<li class="L2 isChef"><a class="sub" href="delivery-schedule.html"><i class="icon-calendar"></i> <span data-bind="text: lang.DeliverySchedule"></span></a></li>
			<li class="L2 isChef"><a class="sub" href="ps-schedule.html"><i class="icon-calendar-1"></i> <span data-bind="text: lang.PSmenu"></span></a></li>
			<li class="L2 isChef"><a class="sub" href="chef-reservations.html"><i class="icon-reserve"></i> <span data-bind="text: lang.ChefReservations"></span></a></li>
			<!--<li class="L2 isChef"><a class="sub" href="chef-events.html"><i class="fa fa-glass"></i> <span data-bind="text: lang.eventResv"></span></a></li>-->
			<li class="L2 isChef"><a class="sub" href="withdraw-money-chef.html"><i class="icon-withdraw"></i> <span data-bind="text: lang.WithdMon"></span></a></li>
			<li class="L1"><a href="settings.html"><i class="icon-gear"></i> <span data-bind="text: lang.Settings"></span></a></li>
			<li class="L1"><a href="about.html"><i class="icon-about"></i> <span data-bind="text: lang.AboutFudi"></span></a></li>
			<li class="L1"><a href="register.html?do=logout"><i class="icon-logout"></i> <span data-bind="text: lang.Logout"></span></a></li>
		</ul>
	</nav>
</div>
<div id="user-profile-page" class="content">
	<h1 id="menu-button"> <a id="menu-toggle" href="#" class="btn-menu toggle"> <i class="fa fa-bars"></i> </a> </h1>
	<p class="pageTitle" data-bind="text: lang.UserProfile"></p>
	<form id="user-form" >
		<div class="form-group col-xs-6 ">
			<label data-bind="text: lang.FirstName"></label>
			<input class="form-control required" type="text" name="first_name" value="" data-bind="attr: { placeholder: lang.FirstName }" placeholder="First Name">
		</div>
		<div class="form-group col-xs-6 last">
			<label data-bind="text: lang.LastName"></label>
			<input class="form-control required" type="text" name="last_name" value="" data-bind="attr: { placeholder: lang.LastName }" placeholder="Last Name">
		</div>
		<div class="form-group">
			<label data-bind="text: lang.Email"></label>
			<input class="form-control" type="email" name="email" value="" data-bind="attr: { placeholder: lang.Email }" placeholder="Email" readonly>
		</div>
		<div class="form-group">
			<label data-bind="text: lang.Phone"></label>
			<input class="form-control required" type="phone" name="phone" value="" data-bind="attr: { placeholder: lang.Phone }" placeholder="Phone">
		</div>
		<div class="form-group">
			<label data-bind="text: lang.Address"></label>
			<input class="form-control" type="text" name="address" value="" data-bind="attr: { placeholder: lang.Address }"  placeholder="Address">
		</div>
		<div class="form-group">
			<label data-bind="text: lang.City"></label>
			<input class="form-control required" type="text" name="city" value="" data-bind="attr: { placeholder: lang.City }"  placeholder="City">
		</div>
		<div class="form-group col-xs-6">
			<label data-bind="text: lang.State"></label>
			<select class="form-control required" name="state" id="state">
				<option value="">-- Select State --</option>
				<option value="AL">Alabama</option>
				<option value="AK">Alaska</option>
				<option value="AZ">Arizona</option>
				<option value="AR">Arkansas</option>
				<option value="CA">California</option>
				<option value="CO">Colorado</option>
				<option value="CT">Connecticut</option>
				<option value="DE">Delaware</option>
				<option value="DC">Dist. of Columbia</option>
				<option value="FL">Florida</option>
				<option value="GA">Georgia</option>
				<option value="HI">Hawaii</option>
				<option value="ID">Idaho</option>
				<option value="IL">Illinois</option>
				<option value="IN">Indiana</option>
				<option value="IA">Iowa</option>
				<option value="KS">Kansas</option>
				<option value="KY">Kentucky</option>
				<option value="LA">Louisiana</option>
				<option value="ME">Maine</option>
				<option value="MD">Maryland</option>
				<option value="MA">Massachusetts</option>
				<option value="MI">Michigan</option>
				<option value="MN">Minnesota</option>
				<option value="MS">Mississippi</option>
				<option value="MO">Missouri</option>
				<option value="MT">Montana</option>
				<option value="NE">Nebraska</option>
				<option value="NV">Nevada</option>
				<option value="NH">New Hampshire</option>
				<option value="NJ">New Jersey</option>
				<option value="NM">New Mexico</option>
				<option value="NY">New York</option>
				<option value="NC">North Carolina</option>
				<option value="ND">North Dakota</option>
				<option value="OH">Ohio</option>
				<option value="OK">Oklahoma</option>
				<option value="OR">Oregon</option>
				<option value="PA">Pennsylvania</option>
				<option value="RI">Rhode Island</option>
				<option value="SC">South Carolina</option>
				<option value="SD">South Dakota</option>
				<option value="TN">Tennessee</option>
				<option value="TX">Texas</option>
				<option value="UT">Utah</option>
				<option value="VT">Vermont</option>
				<option value="VA">Virginia</option>
				<option value="WA">Washington</option>
				<option value="WV">West Virginia</option>
				<option value="WI">Wisconsin</option>
				<option value="WY">Wyoming</option>
			</select>
		</div>
		<div class="form-group col-xs-6 last">
			<label data-bind="text: lang.Zip"></label>
			<input class="form-control required" type="text" name="zip" value="" id="zip" data-bind="attr: { placeholder: lang.Zip }" placeholder="Zip">
		</div>
		<div class="form-group ">
			<label data-bind="text: lang.Refcode"></label>
			<input class="form-control" type="text" pattern="[A-Z0-9]+" maxlength="20" style="text-transform: uppercase" name="refcode_self" value="" id="refcode_self" />
		</div>
		<button type="submit" class="btn btn-positive btn-block btn-submit" data-bind="text: lang.Save"></button>
	</form>
</div>
<br />
<br />
<br />
<br />
<br />
<br />
<div id="bottom-bar">
	<div class="container">
		<div class="row">
			<div class="col-xs-3 no-padding"> <a class="tab-item " href="map.html"> <i class="icon-map"></i> </a> </div>
			<div class="col-xs-3 no-padding"> <a class="tab-item" href="reservations.html"> <i class="icon-bell-covering-hot-dish"></i> </a> </div>
			<div class="col-xs-3 no-padding"> <a class="tab-item active" href="user-profile.html"> <i class="icon-user-1"></i> </a> </div>
			<div class="col-xs-3 no-padding"> <a class="tab-item " id="anoti" href="notifications.html"> <i class="icon-alarm"></i> </a> </div>
		</div>
	</div>
</div>
<script src="js/jquery-1.11.3.min.js"></script> 
<script src="js/jquery.validate.min.js"></script> 
<script src="js/bootstrap.min.js"></script> 
<script src='js/knockout-3.4.0.js'></script> 
<script src="js/common.js"></script> 
<script>

var RetPage = null;

$(document).ready(function(e) {
	
	RetPage = getUrlParameter('ret');
	
	if( localStorage.getItem('userData') === null ){
	
	}else{
		var jsonData = JSON.parse(localStorage.getItem('userData'));
		$('#user-form').find(':input').each(function(){
			el = $(this);
			if( el.prop('type') == 'radio' || el.prop('type') == 'checkbox'  ){
				if( el.val() == jsonData[el.prop('name')] ){ el.prop('checked', true); el.trigger('change'); }
			}else{
				el.val( jsonData[el.prop('name')] );
			}
		});
	}

$('#refcode_self').on('keypress',function (e){
    var regex = new RegExp("^[a-zA-Z0-9]+$");
    var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
    if (regex.test(str)) {
        return true;
    }
    e.preventDefault();
    return false;
});
	
	
$("#user-form").validate({
	errorPlacement: function(error, element) {},
	submitHandler: function(form) {

			formData = $(form).serialize();
			formData += '&userId='+localStorage.getItem('userId')+'&userToken='+localStorage.getItem('userToken'); 
			$.ajax({
				type: "POST", dataType: 'json', url: ServerAjax+"?h=userUpdate", data: formData,
				beforeSend: function() { waitingDialog.show(cLan.Loading, {dialogSize: 'sm', progressType: 'info'}); },
				complete: function() { waitingDialog.hide(); },
			}).fail(  ajaxError )
			.done(function(data){
				if (data.Success == 'true') {
					localStorage.setItem('userData', data.userData );
					BAlert.find('.modal-header h3').html('<i class="fa check"></i>'+cLan.Success);
					BAlert.find('.modal-body').html('<p class="text-success">'+cLan.ProfileUpdated+'</p>');
					if(!empty(RetPage)){
						BAlert.find('.btn-primary').on("click", function(){
							document.location = 'chef_profile.html?id='+RetPage;
						});
					}
					
					BAlert.modal();
				}else{
					if( data.refkeyUnavailable == 'true' ){
						localStorage.setItem('userData', data.userData );
						var jsonData = JSON.parse(localStorage.getItem('userData'));
						$('#refcode_self').val(jsonData.refcode_self);
					} 
					ErrorModalWithParm(data);
				}
				if (data.JS) { eval(data.JS); }
			}); // ajax	

	}// submit handler
});	
	
	
});

</script>
</body>
</html>